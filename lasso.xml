<tool id="lasso2" name="Lasso / Elastic Net" version="0.0.5">
    <description>Lasso / Elastic Net Feature Selection.</description>
    <requirements>
        <requirement type="python-module">rpy2</requirement>
        <requirement type="python-module">pandas</requirement>
        <requirement type="python-module">numpy</requirement>

    </requirements>
    <stdio>
        <exit_code range="1:" level="warning" description="RuntimeWarning"/>
    </stdio>
    <command interpreter="python">
        lasso.py
        --input $input
        --design $design
        --ID $uniqID
        --group $group
        --alpha $alpha

        --coefficients $coefficients
        --flags $flags
        --plots $plots

    </command>
    <inputs>
        <param name="input" type="data" format="tabular" label="Wide Dataset" help="Input dataset in wide format and tab separated. If file is not tab separated see TIP below."/>
        <param name="design" type="data" format="tabular" label="Design File" help="Design file tab separated. Note you need a 'sampleID' column. If not tab separated see TIP below."/>
        <param name="uniqID" type="text" size="30" value="" label="Unique Feature ID" help="Name of the column in your Wide Dataset that has unique Feature IDs."/>
        <param name="group" type="text" size="30" label="Input Group name to separate by" help="Enter group name to calculate from. Spelling and capitalization must be exact."/>
        <param name="alpha" type="text" value=".5" size="30" label="Alpha" help="Default .5"/>

       
    </inputs>
    <outputs>
        <data format="tabular" name="coefficients" label="${tool.name} on ${on_string}: Coefficients"/>
        <data format="tabular" name="flags" label="${tool.name} on ${on_string}: Flags"/>
        <data format="pdf" name="plots" label="${tool.name} on ${on_string}: Plots"/>
    </outputs>
    <macros>
        <import>macros.xml</import>
    </macros>
<help>

@TIP_AND_WARNING@

.. class:: infomark

**Tool Description**

The tool performs feature selection for each pairwise comparison of the levels of the group variable specified by user. The selection method is performed based on the logistic regression with Elastic Net penalty (with LASSO being a special case.) 

The penalty structure is controlled by alpha parameter (defined within [0;1] range) with the default value alpha = 0.5, that can be changed by the user. 
The value alpha = 1 corresponds to LASSO penalty with the strictest selection rule, while the value of the penalty alpha = 0 corresponds to ridge penalty which does not perform variable selection. 

Variable section is performed for all levels of alpha specified by the user in the range (0;1] with the value 1 corresponding the least number of variables and the most strict selection criterion (LASSO), while the value 0 corresponds only to the estimate shrinkage and no selection (ridge). 

The best subset of selected variables for a given alpha is selected by a cross validation procedure. 

More details about the Elastic Net and LASSO penalties can be found in the paper .

Zou, H., and Hastie, T. (2005). Regularization and variable selection via the elastic net. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 67(2), 301-320..

--------------------------------------------------------------------------------

.. class:: warningmark

**Note**

- This tool currently treats all variables as continuous numeric
  variables. Running the tool on categorical variables might result in
  incorrect results. 
- Rows containing non-numeric (or missing) data in any
  of the chosen columns will be skipped from the analysis.

--------------------------------------------------------------------------------

**Input**

- Two input datasets are required.

    @WIDE@

    **NOTE:** The sample IDs must match the sample IDs in the Design File (below).
    Extra columns will automatically be ignored.

    @METADATA@

**In addition to your datasets, you need to provide:**

**Unique Feature ID**

- The column name in your wide dataset that contains the unique IDs for
  your features. In our example dataset you would input *Feature*.

--------------------------------------------------------------------------------

**Output**

- A TSV of the values of the coefficients (including zeroes) that were produced by the tool for each pair of comparisons (in columns) 

- a TSV of the corresponding flags (1 for selected) for the features that were selected by the method. 

- a TSV of the pairs of graphs for all pairwise comparisons. The first graph corresponds to the behavior of coefficients based on the value of the penalty, while the second graph provides the details of cross-validation that was used for the optimal penalty detections which finalized the final set of variables produced by the method.

</help>
</tool>
