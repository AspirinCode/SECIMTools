<tool id="log_transform" name="Log Transformation">
    <description>Transform your data using the log.</description>
    <requirements>
        <requirement type="python-module">numpy</requirement>
        <requirement type="python-module">pandas</requirement>
        <requirement type="python-module">mpld3</requirement>
        <requirement type="python-module">interface</requirement>
        <requirement type="python-module">logger</requirement>
    </requirements>
    <command interpreter="python">log_transform.py
        --input $input
        --design $design
        --ID $uniqID
        --log $log
        --out $out
    </command>
    <inputs>
        <param name="input" type="data" format="tabular" label="Wide Dataset" help="Input dataset in wide format and tab separated. If not tab separated see TIP below."/>
        <param name="design" type="data" format="tabular" label="Metadata File" help="Metadata file tab separated. Note you need a 'sampleID' column. If not tab separated see TIP below"/>
        <param name="uniqID" size="30" type="text" value="" label="Unique Compound ID" help="Name of the column in your Wide Dataset that has unique compound/gene IDs."/>
        <param name="log" size="30" type="select" value="" label="Log Transformation" help="Select type of log.">
            <option value="log" selected="true">Natural Log</option>
            <option value="log2" selected="true">log base 2</option>
            <option value="log10" selected="true">log base 10</option>
        </param>
    </inputs>
    <outputs>
        <data format="tabular" name="out" />
    </outputs>
    <!-- TODO: uncomment the following test when we have tools.update_state() working for
       multiple dependents with the same dependency.
    <tests>
    <test>
      <param name="input" value="scatterplot_in1.tabular" ftype="tabular"/>
      <param name="col1" value="2"/>
      <param name="col2" value="3"/>
      <param name="title" value="Scatterplot"/>
      <param name="xlab" value="V1"/>
      <param name="ylab" value="V2"/>
      <output name="out_file1" file="scatterplot_out1.png" />
    </test>
    </tests>
    -->
<help>

.. class:: infomark

**TIP:**
If your data is not TAB delimited, use *Text Manipulation-&gt;Convert*

.. class:: warningmark

**WARNINGS:**
    - (1) This script automatically removes spaces and special characters from strings.
    - (2) If a compound name starts with a number it will prepend an '_'.

--------------------------------------------------------------------------------

**What it does**

This tool carries out a log transformation on values in a Wide Formated dataset/  It also requires a Metadata dataset.


--------------------------------------------------------------------------------

**Input**

- Two input datasets are required.

    **Wide Formatted Dataset:**

    A wide formatted dataset that contains measurements for each sample.::

        +----------+---------+---------+---------+-----+
        | Compound | sample1 | sample2 | sample3 | ... |
        +==========+=========+=========+=========+=====+
        | one      | 10      | 20      | 10      | ... |
        | two      | 5       | 22      | 30      | ... |
        | three    | 30      | 27      | 2       | ... |
        | four     | 32      | 17      | 8       | ... |
        | ...      | ...     | ...     | ...     | ... |
        +----------+---------+---------+---------+-----+

    **NOTE:** The sample IDs must match the sample IDs in the Metadata File (below).
    Extra columns will automatically be ignored.


    **Metadata File:**
    A Metadata file relating samples to various groups/treatment.::

        +----------+--------+
        | sampleID | group1 |
        +==========+========+
        | sample1  | g1     |
        | sample2  | g1     |
        | sample3  | g1     |
        | sample4  | g2     |
        | sample5  | g2     |
        | sample6  | g2     |
        | ...      | ...    |
        +----------+--------+

    **NOTE: You must have a column named *sampleID***
    and the values in this column must match the columns names in the wide
    formatted dataset. Extra columns will be ignored.

    **In addition to your datasets, you need to provide:**

    **Unique Compound ID**

    - The column name in your wide dataset that contains the unique IDs for
      your compounds. In our example dataset you would input *Compound*



    **Group/Treatment**

    - The name of the column in the Design File that contains the sample treatment groups.  Used to generate a column (sampleID) color bar.



    **Number of trees in the forest**

    - Default of 1000.  We recommend no less than this number.

--------------------------------------------------------------------------------

**Output Files**

- This tool outputs a TSV file of the log transformed data.  Missing values remain missing.


</help>
</tool>

