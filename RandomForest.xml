<tool id="random-forest" name="Random Forest">
    <description> for feature selection.</description>
    <requirements>
        <requirement type="python-module">pandas</requirement>
        <requirement type="python-module">sklearn</requirement>
    </requirements>
    <command interpreter="python">RandomForest.py
        --input $input
        --design $design
        --ID $uniqID
        --group $group
        --num $number_of_estimators
        --out $outfile1
        --out2 $outfile2
    </command>
    <inputs>
        <param name="input" type="data" format="tabular" label="Wide Dataset" help="Input dataset in wide format and tab separated. If not tab separated see TIP below."/>
        <param name="design" type="data" format="tabular" label="Metadata File" help="Metadata file tab separated. Note you need a 'sampleID' column. If not tab separated see TIP below"/>
        <param name="uniqID" type="text" size="30" value="" label="Unique Compound ID" help="Name of the column in your Wide Dataset that has unique compound/gene IDs."/>
        <param name="group" type="text" size="30" value="" label="Group/Treatment" help="Name of the column in your Metadata File that contains group classifications."/>
        <param name="number_of_estimators" type="text" size="30" value="1000" label="Number of trees in the forest" help="Run at least 1000 trees."/>
    </inputs>
    <outputs>
        <data format="csv" name="outfile1" label="Transformed Data"/>
        <data format="csv" name="outfile2" label="Importance Factors"/>
    </outputs>
    <macros>
        <import>macros.xml</import>
    </macros>
    <tests>
        <test>
            <param name="input" value="./test-data/test_data.tsv" />
            <param name="design" value="./test-data/test_design.csv" />
            <param name="uniqID" value="rowID" />
            <param name="group" value="treatment" />
            <param name="number_of_estimators" value="1000" />
            <output name="outfile1" file="./test-data/test_RandomForest_out.tsv" />
            <output name="outfile2" file="./test-data/test_RandomForest_out2.tsv" />
        </test>
    </tests>
<help>

@TIP_AND_WARNING@

**What it does**

This tool uses the Random forest algorithm to identify specific features that differentiate groups/classes.

--------------------------------------------------------------------------------

**Input**

- Two input datasets are required.

    @WIDE@

    **NOTE:** The sample IDs must match the sample IDs in the Design File (below).
    Extra columns will automatically be ignored.


    @METADATA@

    **In addition to your datasets, you need to provide:**

    **Unique Compound ID**

        - The column name in your wide dataset that contains the unique IDs for
        your compounds. In our example dataset you would input *Compound*.

      @GROUP@

    **Number of Trees in the Forest**

        - A typical number of trees is at least 1,000 (default value).  One would
        increase the number of trees in the forest if, upon multiple rerunning of the
        algorithm, the order of importance of features changes significantly.

--------------------------------------------------------------------------------

**Output Files**

- The tool generates 2 output datasets.

**Transformed dataset**:: is a TSV file containing a transformed Wide Dataset where the order of the features in the file reflects their relative importance.

        +----------+----------+----------+----------+----------+
        | sampleID | group    | feature1 | feature3 | feature2 |
        +==========+==========+==========+==========+==========+
        | sample1  | human    | 68       | 0.1      | 4.1      |
        +----------+----------+----------+----------+----------+
        | sample2  | human    | 71       | 0.31     | 4.6      |
        +----------+----------+----------+----------+----------+
        | sample3  | nonhuman | 62       | 0.09     | 3.8      |
        +----------+----------+----------+----------+----------+
        | sample4  | human    | 75       | 0.65     | 4.4      |
        +----------+----------+----------+----------+----------+
        | sample5  | nonhuman | 58       | 0.23     | 3.2      |
        +----------+----------+----------+----------+----------+
        | sample6  | nonhuman | 60       | 0.77     | 3.1      |
        +----------+----------+----------+----------+----------+
        | ...      | ...      | ...      | ...      | ...      |
        +----------+----------+----------+----------+----------+

**rank-order list**:: is a TSV file containing the features in rank-order and their relative importance.

        +----------+------+
        | feature1 | 0.45 |
        +==========+======+
        | feature3 | 0.34 |
        +----------+------+
        | feature2 | 0.22 |
        +----------+------+

**To plot the 2 most important features** use the SECIM scatterplot tool on the transformed dataset to plot the features againt each other and test the separation levels.

</help>
</tool>
